---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
--- 

#Enviroment 
## Loading and preprocessing the data
```{r, echo=FALSE, results=FALSE}
  #Set up enviroment for R scrip  
  # Packages for tidyverse 
    library("tidyverse")
    library("lubridate")
  # Package for building tables in markdown and notebook 
    library("knitr")
    library("kableExtra") 
    library("xtable")
  # Package for forecasting
    library("fpp2")
  # Packages for reading excel and html files and XML
    library("openxlsx")
    library("XML")
  # Parkage for using data tables for very large data operations
    library("data.table")
  #Package for reading fixed width tables
    library("utils")
  # Packages for reading data through API's 
    library("httr")
    library("jsonlite")
  # Package for performing inquires with SQL databases 
    library("sqldf")
  #Package for reading and writing to jpeg files
    library("jpeg")

  # Set proper working Dir
    if (!getwd() == "C:/Users/paulr/Documents/R/Coursera_ReproducibleResearch/RepData_PeerAssessment1") {setwd("C:/Users/paulr/Documents/R/Coursera_ReproducibleResearch/RepData_PeerAssessment1")}
```
Read data in from: https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip


```{r, echo=FALSE, results=FALSE}
activity <- read_csv("./data/activity.zip", col_names = TRUE, col_types = "nDn")
    
```

## What is mean total number of steps taken per day?
I calcualte the total steaps taken each day.
```{r}

activity %>% group_by(date) %>% summarise(SPD = sum(steps)) -> result1

hist(result1$SPD, main = "Total Steps per Day (no NA)", xlab = "Total Steps/Day", border = "blue", col = "brown", breaks = 20)
```



```{r, echo=FALSE}

kable(summary(result1), format = "html", align = "l") %>% kable_styling(c(bootstrap_options = "striped", "bordered"))

```

## What is the average daily activity pattern?
Make a time series plot (type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}

activity %>% na.omit() %>% group_by(interval) %>% summarise(Mean_S = mean(steps)) -> steps_i

ggplot(steps_i, aes(x = interval, y = Mean_S)) +
  geom_line()

```



## Imputing missing values

```{r}

steps_na <- is.na(activity$steps)
# sum(steps_na) 
# sum(!steps_na)
# length(activity$steps[steps_na])

activity_na <- activity[steps_na,]
interval_mean <- match(activity_na$interval, steps_i$interval)
activity_na$steps <- steps_i$Mean_S[interval_mean]
activity %>% na.omit() %>% rbind(activity_na) -> activity_final

summary(activity_final)

```

## Are there differences in activity patterns between weekdays and weekends?

```{r, echo=FALSE }
summary(activity)
summary(activity_final)

activity_final %>% group_by(date) %>% summarise(SPD = sum(steps)) -> result2

result2 %>% kable()

par(mfcol=(c(1,2)))

hist(result2$SPD, main = "Total Steps per Day (Imputed NA)", xlab = "Total Steps/Day", border = "blue", col = "brown", breaks = 20)

hist(result1$SPD, main = "Total Steps per Day (Omit NA)", xlab = "Total Steps/Day", border = "blue", col = "brown", breaks = 20)

kable(summary(result2), format = "html", align = "l") %>% kable_styling(c(bootstrap_options = "striped", "bordered"))




```

